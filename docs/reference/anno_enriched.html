<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Annotation Function to Show the Enrichment — anno_enriched • EnrichedHeatmap</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Annotation Function to Show the Enrichment — anno_enriched" />
<meta property="og:description" content="Annotation Function to Show the Enrichment" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnrichedHeatmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.15.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/EnrichedHeatmap.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/roadmap.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/row_odering.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/visualize_categorical_signals_wrapper.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jokergoo/EnrichedHeatmap">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Annotation Function to Show the Enrichment</h1>
    
    <div class="hidden name"><code>anno_enriched.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Annotation Function to Show the Enrichment</p>
    </div>

    <pre class="usage"><span class='fu'>anno_enriched</span>(<span class='kw'>gp</span> <span class='kw'>=</span> <span class='fu'>gpar</span>(<span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"red"</span>), <span class='kw'>pos_line</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pos_line_gp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"mean"</span>, <span class='st'>"sum"</span>, <span class='st'>"abs_mean"</span>, <span class='st'>"abs_sum"</span>),
    <span class='kw'>yaxis</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>axis</span> <span class='kw'>=</span> <span class='no'>yaxis</span>, <span class='kw'>axis_param</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>side</span> <span class='kw'>=</span> <span class='st'>"right"</span>),
    <span class='kw'>show_error</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>height</span> <span class='kw'>=</span> <span class='fu'>unit</span>(<span class='fl'>2</span>, <span class='st'>"cm"</span>), <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gp</th>
      <td><p>Graphic parameters. There are two non-standard parameters: <code>neg_col</code> and <code>pos_col</code>.  If these two parameters are defined, the positive signals and negatie signals are visualized separatedly. The graphic parameters can be set as vectors when the heatmap or heatmap list is split into several row clusters.</p></td>
    </tr>
    <tr>
      <th>pos_line</th>
      <td><p>Whether draw vertical lines which represent positions of <code>target</code>?</p></td>
    </tr>
    <tr>
      <th>pos_line_gp</th>
      <td><p>Graphic parameters for the position lines.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>Ranges on y-axis. By default it is inferred from the data.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The method to summarize signals from columns of the normalized matrix.</p></td>
    </tr>
    <tr>
      <th>yaxis</th>
      <td><p>Deprecated, use <code>axis</code> instead.</p></td>
    </tr>
    <tr>
      <th>axis</th>
      <td><p>Whether show axis?</p></td>
    </tr>
    <tr>
      <th>axis_param</th>
      <td><p>parameters for controlling axis. See <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/default_axis_param.html'>default_axis_param</a></code> for all possible settings and default parameters.</p></td>
    </tr>
    <tr>
      <th>show_error</th>
      <td><p>Whether show error regions which are one standard error to the mean value? Color of error area is same as the corresponding lines with 75 percent transparency.</p></td>
    </tr>
    <tr>
      <th>height</th>
      <td><p>Height of the annotation.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This annotation functions shows mean values (or depends on the method set in <code>value</code> argument) of columns in the normalized matrix
which summarises the enrichment of the signals to the targets.</p>
<p>If rows are splitted, the enriched lines are calculated for each row cluster and there will also be multiple lines in this annotation viewport.</p>
<p>It should only be placed as column annotation of the enriched heatmap.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A column annotation function which should be set to <code>top_annotation</code> argument in <code>EnrichedHeatmap</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"chr21_test_data.RData"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"EnrichedHeatmap"</span>))
<span class='no'>tss</span> <span class='kw'>=</span> <span class='fu'>promoters</span>(<span class='no'>genes</span>, <span class='kw'>upstream</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>downstream</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>mat1</span> <span class='kw'>=</span> <span class='fu'>normalizeToMatrix</span>(<span class='no'>H3K4me3</span>, <span class='no'>tss</span>, <span class='kw'>value_column</span> <span class='kw'>=</span> <span class='st'>"coverage"</span>,
    <span class='kw'>extend</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>mean_mode</span> <span class='kw'>=</span> <span class='st'>"w0"</span>, <span class='kw'>w</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>keep</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.99</span>))
<span class='fu'>EnrichedHeatmap</span>(<span class='no'>mat1</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"white"</span>, <span class='st'>"red"</span>), <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"H3K4me3"</span>,
    <span class='kw'>top_annotation</span> <span class='kw'>=</span> <span class='fu'>HeatmapAnnotation</span>(<span class='kw'>lines</span> <span class='kw'>=</span> <span class='fu'>anno_enriched</span>(<span class='kw'>gp</span> <span class='kw'>=</span> <span class='fu'>gpar</span>(<span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>4</span>))),
    <span class='kw'>km</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>row_title_rot</span> <span class='kw'>=</span> <span class='fl'>0</span>)</div><div class='img'><img src='anno_enriched-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Zuguang Gu &lt;z.gu@dkfz.de&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


